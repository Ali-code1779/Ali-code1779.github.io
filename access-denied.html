<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Ù„ÙˆØ­Ø© Ø§Ù„ØªØ­ÙƒÙ… Ø§Ù„Ø¥Ø¯Ø§Ø±ÙŠØ© | Admin Panel</title>
  <style>
    * { box-sizing: border-box; margin: 0; padding: 0; }
    html, body {
      width: 100%;
      height: 100%;
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      transition: background-color 0.3s, color 0.3s;
    }
    body {
      background-color: #eef3f8;
      color: #000;
      padding: 2vh 0 40px 0;
      overflow-x: hidden;
    }
    .dark-mode {
      background-color: #1e1e2f;
      color: #f0f0f0;
    }
    .top-bar {
      display: flex;
      justify-content: center;
      gap: 10px;
      margin: 18px 0 24px 0;
      flex-wrap: wrap;
    }
    .top-bar button {
      background-color: #0078d4;
      color: white;
      border: none;
      padding: 0.6em 1em;
      border-radius: 10px;
      cursor: pointer;
      font-size: 0.95rem;
      transition: background-color 0.3s;
    }
    .top-bar button:hover { background-color: #005fa3; }
    .dark-mode .top-bar button {
      background-color: #66ccff;
      color: #000;
    }
    .dark-mode .top-bar button:hover { background-color: #4bb8ee; }
    h1, h2 {
      color: #007BFF;
      text-align: center;
      margin-bottom: 24px;
    }
    .dark-mode h1, .dark-mode h2 { color: #66ccff; }
    .summary-cards {
      display: flex;
      gap: 15px;
      flex-wrap: wrap;
      justify-content: center;
      margin-bottom: 28px;
    }
    .card {
      background: white;
      border-radius: 8px;
      padding: 20px;
      flex: 1 1 200px;
      box-shadow: 0 0 10px rgba(0,0,0,0.1);
      text-align: center;
      min-width: 200px;
      max-width: 260px;
      transition: background 0.3s, color 0.3s;
    }
    .dark-mode .card { background: #2e2e3e; color: #f0f0f0; }
    .card h2 { margin: 0 0 10px; font-size: 2.2em; color: #333; }
    .dark-mode .card h2 { color: #66ccff; }
    .card p { margin: 0; font-size: 1em; color: #666; }
    .dark-mode .card p { color: #b0c4d4; }

    .lists-section {
      display: flex;
      gap: 30px;
      justify-content: center;
      flex-wrap: wrap;
      margin-bottom: 40px;
    }
    .list-box {
      background: #fff;
      border-radius: 12px;
      box-shadow: 0 0 8px rgba(0,0,0,0.07);
      padding: 18px 16px;
      min-width: 260px;
      max-width: 350px;
      flex: 1 1 260px;
      margin-bottom: 18px;
      transition: background 0.3s, color 0.3s;
    }
    .dark-mode .list-box {
      background: #2e2e3e;
      color: #f0f0f0;
    }
    .list-box h3 {
      margin-bottom: 10px;
      font-size: 1.12em;
      color: #0078d4;
    }
    .dark-mode .list-box h3 { color: #66ccff; }
    .list-box ul {
      list-style: none;
      padding: 0;
      margin: 0;
    }
    .list-box li {
      padding: 6px 0;
      border-bottom: 1px solid #eee;
      font-size: 0.98em;
      display: flex;
      align-items: center;
      gap: 6px;
    }
    .dark-mode .list-box li { border-bottom: 1px solid #444; }
    .list-box li:last-child { border-bottom: none; }
    .list-box .icon { font-size: 1.1em; }
    .features-section {
      width: 100%;
      max-width: 1200px;
      margin: 0 auto;
      padding: 2vh 2vw;
      border-radius: 20px;
      display: flex;
      flex-direction: column;
      justify-content: space-between;
    }
    .features-section h2 {
      font-size: calc(1.6rem + 0.5vw);
      color: #005a9c;
      text-align: center;
      margin-bottom: 2vh;
    }
    .dark-mode .features-section h2 { color: #66ccff; }
    .features-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
      gap: 2vw;
    }
    .feature-box {
      background-color: white;
      padding: 2vh 1vw;
      border-radius: 15px;
      box-shadow: 0 8px 20px rgba(0, 0, 0, 0.08);
      text-align: center;
      transition: transform 0.3s, box-shadow 0.3s, background-color 0.3s;
    }
    .dark-mode .feature-box {
      background-color: #2e2e3e;
      box-shadow: 0 8px 20px rgba(255, 255, 255, 0.05);
    }
    .feature-box:hover {
      transform: translateY(-5px);
      box-shadow: 0 12px 24px rgba(0, 90, 156, 0.2);
    }
    .dark-mode .feature-box:hover {
      box-shadow: 0 12px 24px rgba(102, 204, 255, 0.3);
    }
    .feature-icon {
      font-size: 2.5rem;
      margin-bottom: 1vh;
      color: #0078d4;
    }
    .dark-mode .feature-icon { color: #66ccff; }
    .feature-box h3 {
      font-size: calc(1rem + 0.3vw);
      margin-bottom: 1vh;
    }
    .feature-box p {
      font-size: calc(0.85rem + 0.1vw);
      line-height: 1.5;
    }
    @media (max-width: 800px) {
      .summary-cards { flex-direction: column; align-items: center; }
      .lists-section { flex-direction: column; gap: 10px; align-items: center; }
      .features-grid { grid-template-columns: 1fr; }
    }
    @media (max-width: 480px) {
      .top-bar { flex-direction: column; gap: 10px; align-items: center; }
      .features-section { padding: 1vh 1vw; }
    }
  </style>
</head>
<body>
  <div class="top-bar">
    <button onclick="toggleLanguage()">ğŸŒ ØªØºÙŠÙŠØ± Ø§Ù„Ù„ØºØ© / Change Language</button>
    <button onclick="toggleDarkMode()">ğŸŒ“ Ø§Ù„ÙˆØ¶Ø¹ Ø§Ù„Ù„ÙŠÙ„ÙŠ / Dark Mode</button>
    <button onclick="fetchStats()" id="refreshBtn">ğŸ”„ ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª / Refresh</button>
  </div>

  <h1 id="main-title">Ù„ÙˆØ­Ø© Ø§Ù„ØªØ­ÙƒÙ… - Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©</h1>
  <div class="summary-cards">
    <div class="card">
      <h2 id="usersCount">-</h2>
      <p data-en="Users" data-ar="Ø¹Ø¯Ø¯ Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…ÙŠÙ†">Ø¹Ø¯Ø¯ Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…ÙŠÙ†</p>
    </div>
    <div class="card">
      <h2 id="appsCount">-</h2>
      <p data-en="Applications" data-ar="Ø¹Ø¯Ø¯ Ø§Ù„ØªØ·Ø¨ÙŠÙ‚Ø§Øª">Ø¹Ø¯Ø¯ Ø§Ù„ØªØ·Ø¨ÙŠÙ‚Ø§Øª</p>
    </div>
    <div class="card">
      <h2 id="reportsCount">-</h2>
      <p data-en="New Reports" data-ar="ØªÙ‚Ø§Ø±ÙŠØ± Ø¬Ø¯ÙŠØ¯Ø©">ØªÙ‚Ø§Ø±ÙŠØ± Ø¬Ø¯ÙŠØ¯Ø©</p>
    </div>
  </div>

  <div class="lists-section">
    <div class="list-box">
      <h3 id="latestUsersTitle">Ø£Ø­Ø¯Ø« Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…ÙŠÙ†</h3>
      <ul id="latestUsersList">
        <li>...</li>
      </ul>
    </div>
    <div class="list-box">
      <h3 id="latestAppsTitle">Ø£Ø­Ø¯Ø« Ø§Ù„ØªØ·Ø¨ÙŠÙ‚Ø§Øª</h3>
      <ul id="latestAppsList">
        <li>...</li>
      </ul>
    </div>
  </div>

  <section class="features-section">
    <h2 id="features-title">Ø§Ù„Ø®ØµØ§Ø¦Øµ Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©</h2>
    <div class="features-grid" id="features-grid">
      <div class="feature-box">
        <span class="feature-icon">ğŸ‘¤</span>
        <h3 data-en="Manage Users" data-ar="Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…ÙŠÙ†">Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…ÙŠÙ†</h3>
        <p data-en="Create, edit and delete user profiles and assign access rights."
           data-ar="Ø¥Ù†Ø´Ø§Ø¡ØŒ ØªØ¹Ø¯ÙŠÙ„ØŒ Ø­Ø°Ù Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…ÙŠÙ† ÙˆØªØ­Ø¯ÙŠØ¯ ØµÙ„Ø§Ø­ÙŠØ§ØªÙ‡Ù….">
          Ø¥Ù†Ø´Ø§Ø¡ØŒ ØªØ¹Ø¯ÙŠÙ„ØŒ Ø­Ø°Ù Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…ÙŠÙ† ÙˆØªØ­Ø¯ÙŠØ¯ ØµÙ„Ø§Ø­ÙŠØ§ØªÙ‡Ù….
        </p>
      </div>
      <div class="feature-box">
        <span class="feature-icon">ğŸ§©</span>
        <h3 data-en="Assign Applications" data-ar="Ø±Ø¨Ø· Ø§Ù„ØªØ·Ø¨ÙŠÙ‚Ø§Øª">Ø±Ø¨Ø· Ø§Ù„ØªØ·Ø¨ÙŠÙ‚Ø§Øª</h3>
        <p data-en="Link specific apps and workspaces to each user with time limits."
           data-ar="ØªØ®ØµÙŠØµ Ø§Ù„ØªØ·Ø¨ÙŠÙ‚Ø§Øª ÙˆÙ…Ø³Ø§Ø­Ø§Øª Ø§Ù„Ø¹Ù…Ù„ Ù„Ù„Ù…Ø³ØªØ®Ø¯Ù…ÙŠÙ† Ù…Ø¹ ØªØ­Ø¯ÙŠØ¯ Ø§Ù„Ù…Ø¯Ø©.">
          ØªØ®ØµÙŠØµ Ø§Ù„ØªØ·Ø¨ÙŠÙ‚Ø§Øª ÙˆÙ…Ø³Ø§Ø­Ø§Øª Ø§Ù„Ø¹Ù…Ù„ Ù„Ù„Ù…Ø³ØªØ®Ø¯Ù…ÙŠÙ† Ù…Ø¹ ØªØ­Ø¯ÙŠØ¯ Ø§Ù„Ù…Ø¯Ø©.
        </p>
      </div>
      <div class="feature-box">
        <span class="feature-icon">ğŸ“…</span>
        <h3 data-en="Validity Control" data-ar="Ø§Ù„ØªØ­ÙƒÙ… ÙÙŠ Ø§Ù„ØµÙ„Ø§Ø­ÙŠØ©">Ø§Ù„ØªØ­ÙƒÙ… ÙÙŠ Ø§Ù„ØµÙ„Ø§Ø­ÙŠØ©</h3>
        <p data-en="Define valid periods for user access to each module or app."
           data-ar="ØªØ­Ø¯ÙŠØ¯ ØµÙ„Ø§Ø­ÙŠØ§Øª Ø§Ù„ÙˆØµÙˆÙ„ Ø­Ø³Ø¨ Ø§Ù„ÙØªØ±Ø§Øª Ø§Ù„Ø²Ù…Ù†ÙŠØ©.">
          ØªØ­Ø¯ÙŠØ¯ ØµÙ„Ø§Ø­ÙŠØ§Øª Ø§Ù„ÙˆØµÙˆÙ„ Ø­Ø³Ø¨ Ø§Ù„ÙØªØ±Ø§Øª Ø§Ù„Ø²Ù…Ù†ÙŠØ©.
        </p>
      </div>
      <div class="feature-box">
        <span class="feature-icon">ğŸ“ˆ</span>
        <h3 data-en="Monitor Activity" data-ar="Ù…Ø±Ø§Ù‚Ø¨Ø© Ø§Ù„Ù†Ø´Ø§Ø·">Ù…Ø±Ø§Ù‚Ø¨Ø© Ø§Ù„Ù†Ø´Ø§Ø·</h3>
        <p data-en="Track user activity, logs, and performance statistics."
           data-ar="Ù…ØªØ§Ø¨Ø¹Ø© Ø§Ù„Ù†Ø´Ø§Ø· ÙˆØªØ­Ù„ÙŠÙ„ Ø§Ù„Ø£Ø¯Ø§Ø¡ ÙˆØ§Ù„Ø¥Ø­ØµØ§Ø¡Ø§Øª.">
          Ù…ØªØ§Ø¨Ø¹Ø© Ø§Ù„Ù†Ø´Ø§Ø· ÙˆØªØ­Ù„ÙŠÙ„ Ø§Ù„Ø£Ø¯Ø§Ø¡ ÙˆØ§Ù„Ø¥Ø­ØµØ§Ø¡Ø§Øª.
        </p>
      </div>
    </div>
  </section>
<script>
const WEB_APP_URL = "https://script.google.com/macros/s/AKfycbz7Aww_mTHklvxX8gT-KNcR4BLQeeNuB_0JovaO2jH3lORdvYnrMLDVnTe-e6i_WBQ-lQ/exec";
let currentLang = 'ar';

function toggleLanguage() {
  currentLang = currentLang === 'ar' ? 'en' : 'ar';
  document.documentElement.lang = currentLang;
  document.documentElement.dir = currentLang === 'ar' ? 'rtl' : 'ltr';
  // ... (ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø¹Ù†Ø§ÙˆÙŠÙ† ÙƒÙ…Ø§ ÙÙŠ ÙƒÙˆØ¯Ùƒ)
}

async function fetchStats() {
  try {
    // Ø¹Ø¯Ø¯ Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…ÙŠÙ†
    const usersRes = await fetch(WEB_APP_URL + "?resource=users&method=get");
    const usersData = await usersRes.json();
    document.getElementById('usersCount').innerText = usersData.total || (usersData.data ? usersData.data.length : 0);

    // Ø¬Ù„Ø¨ Ø£Ø­Ø¯Ø« Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…ÙŠÙ† (Ø¢Ø®Ø± 5)
    const usersList = (usersData.data || []).sort((a, b) => new Date(b.createdAt) - new Date(a.createdAt)).slice(0, 5);
    document.getElementById('latestUsersList').innerHTML =
      usersList.length
        ? usersList.map(u =>
            `<li><span class="icon">ğŸ‘¤</span> ${u.name || u.username || u.email || ''}</li>`
          ).join('')
        : `<li>${currentLang === 'ar' ? 'Ù„Ø§ ÙŠÙˆØ¬Ø¯ Ù…Ø³ØªØ®Ø¯Ù…ÙˆÙ†' : 'No users found'}</li>`;

    // Ø¹Ø¯Ø¯ Ø§Ù„ØªØ·Ø¨ÙŠÙ‚Ø§Øª
    const appsRes = await fetch(WEB_APP_URL + "?resource=apps&method=get");
    const appsData = await appsRes.json();
    document.getElementById('appsCount').innerText = appsData.total || (appsData.data ? appsData.data.length : 0);

    // Ø¬Ù„Ø¨ Ø£Ø­Ø¯Ø« Ø§Ù„ØªØ·Ø¨ÙŠÙ‚Ø§Øª (Ø¢Ø®Ø± 5)
    const appsList = (appsData.data || []).sort((a, b) => new Date(b.createdAt) - new Date(a.createdAt)).slice(0, 5);
    document.getElementById('latestAppsList').innerHTML =
      appsList.length
        ? appsList.map(a =>
            `<li><span class="icon">ğŸ§©</span> ${a.Name_AR || a.Name_EN || a.AppID || ''}</li>`
          ).join('')
        : `<li>${currentLang === 'ar' ? 'Ù„Ø§ ÙŠÙˆØ¬Ø¯ ØªØ·Ø¨ÙŠÙ‚Ø§Øª' : 'No apps found'}</li>`;

    // Ø¹Ø¯Ø¯ Ø§Ù„ØªÙ‚Ø§Ø±ÙŠØ± Ø§Ù„Ø¬Ø¯ÙŠØ¯Ø© (Ù…Ù† logs Ø¨ØªØ§Ø±ÙŠØ® Ø§Ù„ÙŠÙˆÙ…)
    const logsRes = await fetch(WEB_APP_URL + "?resource=logs&method=get");
    const logsData = await logsRes.json();
    const today = new Date();
    const todayStr = today.toISOString().substring(0, 10); // yyyy-mm-dd
    const newReports = (logsData.data || []).filter(log => {
      if (!log.timestamp) return false;
      return log.timestamp.startsWith(todayStr);
    }).length;
    document.getElementById('reportsCount').innerText = newReports;
  } catch (err) {
    document.getElementById('usersCount').innerText = '-';
    document.getElementById('appsCount').innerText = '-';
    document.getElementById('reportsCount').innerText = '-';
    document.getElementById('latestUsersList').innerHTML = `<li>Ø®Ø·Ø£ ÙÙŠ Ø¬Ù„Ø¨ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª</li>`;
    document.getElementById('latestAppsList').innerHTML = `<li>Ø®Ø·Ø£ ÙÙŠ Ø¬Ù„Ø¨ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª</li>`;
  }
}

window.onload = fetchStats;
</script>
</body>
</html>
