<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="UTF-8">
  <title>Ù„ÙˆØ­Ø© Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… ğŸ‘¤</title>
  <style>
    * { box-sizing: border-box; }
    body {
      font-family: 'Arial', sans-serif;
      margin: 0;
      padding: 0;
      direction: rtl;
      background-color: #f5f5f5;
    }

    header {
      position: fixed;
      top: 0;
      left: 0;
      right: 0;
      height: 60px;
      background-color: #007BFF;
      color: white;
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 0 20px;
      z-index: 1000;
    }

    header .controls {
      display: flex;
      align-items: center;
      gap: 10px;
    }

    header .controls button {
      padding: 6px 10px;
      border: none;
      border-radius: 5px;
      cursor: pointer;
      background-color: white;
      color: #007BFF;
      font-weight: bold;
    }

    .menu-container {
      display: flex;
      flex-wrap: wrap;
      justify-content: center;
      gap: 10px;
      background-color: #ffffff;
      padding: 10px 0;
      border-bottom: 1px solid #ccc;
      position: sticky;
      top: 60px;
      z-index: 999;
    }

    .menu-container button {
      background-color: #007BFF;
      color: white;
      border: none;
      padding: 8px 15px;
      border-radius: 5px;
      font-size: 14px;
      cursor: pointer;
      transition: 0.2s;
    }

    .menu-container button:hover {
      background-color: #0056b3;
    }

    .workspace {
      margin-top: 120px;
      padding: 20px;
      min-height: calc(100vh - 120px);
      position: relative;
    }

    iframe.page-frame {
      width: 100%;
      height: 80vh;
      border: none;
      background: white;
      border-radius: 10px;
      box-shadow: 0 0 10px rgba(0,0,0,0.1);
    }

    .spinner {
      position: absolute;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      display: none;
      font-size: 24px;
      color: #007BFF;
    }
  </style>
</head>
<body>

<header>
  <div id="title">Ù„ÙˆØ­Ø© Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… ğŸ‘¤</div>
  <div class="controls">
    <span id="date"></span>
    <button onclick="toggleLang()">ğŸŒ English</button>
    <button onclick="logout()">ğŸšª ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø®Ø±ÙˆØ¬</button>
  </div>
</header>

<div class="menu-container" id="topMenu">
  <!-- Ø§Ù„Ù‚ÙˆØ§Ø¦Ù… ÙŠØªÙ… ØªÙˆÙ„ÙŠØ¯Ù‡Ø§ Ø­Ø³Ø¨ Ø§Ù„ØµÙ„Ø§Ø­ÙŠØ§Øª -->
</div>

<main class="workspace">
  <div class="spinner" id="spinner">â³ Ø¬Ø§Ø±ÙŠ Ø§Ù„ØªØ­Ù…ÙŠÙ„...</div>
  <iframe src="" id="pageFrame" class="page-frame" onload="hideSpinner()"></iframe>
</main>

<script>
  let lang = 'ar';

  let user = JSON.parse(localStorage.getItem("user")) || { name: "Ø²Ø§Ø¦Ø±", role: "user" };

  const menuItems = [
    { id: 'dashboard', icon: 'ğŸ“Š', page: 'pages/user_dashboard.html', roles: ['user', 'admin'] },
    { id: 'apps', icon: 'ğŸ§©', page: 'pages/apps.html', roles: ['user', 'admin'] },
    { id: 'viewPrograms', icon: 'ğŸ“º', page: 'pages/viewPrograms.html', roles: ['user', 'admin'] },
  ];

  const labels = {
    ar: {
      dashboard: "Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©",
      apps: "Ø§Ù„ØªØ·Ø¨ÙŠÙ‚Ø§Øª",
      viewPrograms: "Ø§Ù„Ø¨Ø±Ø§Ù…Ø¬ Ø§Ù„Ù…ØªØ§Ø­Ø©",
      logout: "ğŸšª ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø®Ø±ÙˆØ¬",
      title: "Ù„ÙˆØ­Ø© Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… ğŸ‘¤"
    },
    en: {
      dashboard: "Dashboard",
      apps: "Apps",
      viewPrograms: "View Programs",
      logout: "ğŸšª Logout",
      title: "User Dashboard ğŸ‘¤"
    }
  };

  function toggleLang() {
    lang = lang === 'ar' ? 'en' : 'ar';
    document.documentElement.lang = lang;
    document.body.dir = lang === 'ar' ? 'rtl' : 'ltr';
    document.getElementById("title").innerText = labels[lang].title;
    document.querySelector("button[onclick='logout()']").innerText = labels[lang].logout;
    document.querySelector("button[onclick='toggleLang()']").innerText = lang === 'ar' ? 'ğŸŒ English' : 'ğŸŒ Ø§Ù„Ø¹Ø±Ø¨ÙŠØ©';
    document.getElementById("date").textContent = new Date().toLocaleDateString(lang === 'ar' ? 'ar-EG' : 'en-US');
    renderMenu();
  }

  function logout() {
    localStorage.removeItem("user");
    window.location.href = "login.html";
  }

  function renderMenu() {
    const menu = document.getElementById("topMenu");
    menu.innerHTML = "";
    menuItems.forEach(item => {
      if (item.roles.includes(user.role)) {
        const btn = document.createElement("button");
        btn.innerHTML = `${item.icon} ${labels[lang][item.id]}`;
        btn.onclick = () => loadPage(item.page);
        menu.appendChild(btn);
      }
    });
  }

  function loadPage(pageUrl) {
    const frame = document.getElementById("pageFrame");
    document.getElementById("spinner").style.display = 'block';
    frame.src = pageUrl;
  }

  function hideSpinner() {
    document.getElementById("spinner").style.display = 'none';
  }

  window.onload = () => {
    if (!user || user.role !== 'user') {
      logout();
    }
    document.getElementById("date").textContent = new Date().toLocaleDateString(lang === 'ar' ? 'ar-EG' : 'en-US');
    renderMenu();
    loadPage("pages/user_dashboard.html");
  };
</script>

</body>
</html>
