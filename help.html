<!DOCTYPE html>
<html lang="en" dir="ltr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>â“ Help & Support - Restaurant Ops Platform</title>
<style>
:root{
  --main:#1d4ed8;
  --dark:#0f172a;
  --light:#f8fafc;
  --card:#e2e8f0;
  --text:#1e293b;
  --gray:#94a3b8;
  --success:#10b981;
}
*{box-sizing:border-box;margin:0;padding:0;}
body{
  font-family:Segoe UI,Tahoma,sans-serif;
  background:var(--light);
  color:var(--text);
  display:flex;
  flex-direction:column;
  min-height:100vh;
  overflow-x:hidden;
  transition:all .3s;
}
body.dark{background:var(--dark);color:#fff;}

header{
  position:fixed;
  top:0;left:0;
  width:100%;
  background:var(--main);
  color:#fff;
  padding:10px 20px;
  z-index:1000;
  display:flex;
  justify-content:space-between;
  align-items:center;
  flex-wrap:wrap;
}
.logo{font-weight:bold;font-size:1.1rem;}
.controls{
  display:flex;
  gap:8px;
  flex-wrap:wrap;
  align-items:center;
}
.controls button{
  border:none;
  padding:6px 10px;
  border-radius:5px;
  font-weight:bold;
  cursor:pointer;
}
.controls button.disabled{
  opacity:.7;
  cursor:default;
}
.datetime{
  font-size:.85rem;
  min-width:190px;
  text-align:center;
}

/* MAIN */
main{
  flex:1 0 auto;
  margin-top:80px;
  width:92%;
  max-width:950px;
  margin-left:auto;
  margin-right:auto;
  display:flex;
  flex-direction:column;
  gap:18px;
}

/* ÙƒØ±Øª Ø§Ù„Ù‡ÙŠØ±Ùˆ */
.hero-card{
  width:100%;
  border-radius:12px;
  overflow:hidden;
  box-shadow:0 2px 5px rgba(0,0,0,0.08);
  background:var(--card);
}
body.dark .hero-card{
  background:#1e293b;
  color:#fff;
}
.hero-inner{
  display:flex;
  flex-wrap:wrap;
  gap:18px;
  align-items:center;
  padding:18px 20px;
}
.hero-text{
  flex:1 1 260px;
}
.hero-title{
  font-size:1.4rem;
  margin-bottom:6px;
}
.hero-subtitle{
  font-size:0.95rem;
  color:var(--gray);
}
body.dark .hero-subtitle{color:#cbd5f5;}
.hero-badges{
  margin-top:10px;
  display:flex;
  flex-wrap:wrap;
  gap:8px;
}
.hero-badge{
  background:#fff;
  color:var(--text);
  border-radius:999px;
  padding:4px 10px;
  font-size:0.8rem;
}
body.dark .hero-badge{
  background:#0b1120;
  color:#e5e7eb;
}

.hero-img{
  flex:0 0 260px;
  max-width:280px;
  margin-left:auto;
  margin-right:auto;
}
.hero-img img{
  width:100%;
  height:auto;
  display:block;
  border-radius:14px;
  box-shadow:0 8px 20px rgba(0,0,0,0.12);
  object-fit:cover;
}

/* Ø§Ù„Ø­Ø§ÙˆÙŠØ© Ø§Ù„Ø¹Ø§Ù…Ø© */
.container{
  flex:1;
  display:flex;
  flex-direction:column;
  border-radius:12px;
  overflow:hidden;
  box-shadow:0 2px 5px rgba(0,0,0,0.1);
  background:#fff;
}
body.dark .container{
  background:#1e293b;
  color:#fff;
}
.headerBar{
  background:var(--main);
  color:#fff;
  padding:12px 16px;
  display:flex;
  justify-content:space-between;
  align-items:center;
  flex-shrink:0;
}
.headerBar-title{
  font-weight:600;
  display:flex;
  align-items:center;
  gap:6px;
}
.headerBar-actions{
  display:flex;
  gap:8px;
}
.headerBar-actions button{
  border:none;
  padding:6px 10px;
  border-radius:6px;
  font-weight:bold;
  cursor:pointer;
}
.headerBar-actions button.secondary{
  background:#eff6ff;
  color:#1d4ed8;
}
.headerBar-actions button.primary{
  background:#fbbf24;
  color:#1f2937;
}

.innerContent{
  overflow-y:auto;
  flex:1;
  padding:15px;
  max-height:520px;
}

/* FAQ accordion */
.accordion .item{
  margin-bottom:10px;
  border-radius:8px;
  overflow:hidden;
  border:1px solid #cbd5e1;
}
.accordion .question{
  width:100%;
  background:#f1f5f9;
  border:none;
  padding:10px 12px;
  display:flex;
  justify-content:space-between;
  align-items:center;
  font-weight:bold;
  cursor:pointer;
  font-size:0.95rem;
  transition:0.3s;
}
.accordion .question span.icon{
  margin-left:8px;
  transition:transform 0.3s;
}
.accordion .answer{
  display:none;
  padding:10px 12px;
  background:#e2e8f0;
  line-height:1.6;
  font-size:0.9rem;
}
body.dark .accordion .question{
  background:#334155;
  color:#fff;
}
body.dark .accordion .answer{
  background:#020617;
  color:#e5e7eb;
}

/* ØªÙ„Ù…ÙŠØ­Ø§Øª Ø³Ø±ÙŠØ¹Ø© */
.quick-tips{
  margin-top:10px;
  padding:10px;
  border-radius:8px;
  background:#ecfeff;
  font-size:0.85rem;
}
body.dark .quick-tips{
  background:#022c22;
}

/* Ø§Ù„ØªØ°ÙƒØ±Ø© Ùˆ AI Chat */
.ticket,
.aiChat{
  display:none;
  flex-direction:column;
  margin-top:10px;
  border-radius:12px;
  overflow:hidden;
  box-shadow:0 2px 5px rgba(0,0,0,0.1);
  background:#fff;
}
body.dark .ticket,
body.dark .aiChat{
  background:#1e293b;
}

.ticket-body,
.ai-body{
  padding:16px;
}
.ticket input,
.ticket textarea,
.aiChat textarea{
  width:100%;
  padding:10px;
  margin:8px 0;
  border-radius:6px;
  border:1px solid #cbd5e1;
  box-sizing:border-box;
  font-size:0.9rem;
}
body.dark .ticket input,
body.dark .ticket textarea,
body.dark .aiChat textarea{
  background:#0b1120;
  color:#e5e7eb;
  border-color:#1f2937;
}
.ticket button,
.aiChat button{
  background:#fff;
  padding:9px 14px;
  border:none;
  border-radius:6px;
  font-weight:bold;
  cursor:pointer;
  font-size:0.9rem;
}
.ticket button.submitBtn{
  background:#10b981;
  color:#fff;
}
.ticket button.submitBtn:hover{
  background:#059669;
}
.ticket button.backBtn,
.aiChat button.backBtn{
  background:#e5e7eb;
  color:#111827;
}
body.dark .ticket button.backBtn,
body.dark .aiChat button.backBtn{
  background:#111827;
  color:#e5e7eb;
}

.aiChat .chatArea{
  background:#e2e8f0;
  color:#000;
  padding:10px;
  border-radius:6px;
  max-height:260px;
  overflow-y:auto;
  margin-bottom:8px;
  font-size:0.88rem;
}
body.dark .aiChat .chatArea{
  background:#020617;
  color:#e5e7eb;
}
.chatArea .msg{
  margin-bottom:6px;
}
.chatArea .msg b{
  margin-right:4px;
}

/* FOOTER */
footer{
  flex-shrink:0;
  text-align:center;
  padding:14px;
  opacity:.75;
  font-size:0.85rem;
}
</style>
</head>
<body>

<header>
  <div class="logo">ğŸ½ï¸ Restaurant Ops Platform</div>
  <div class="controls">
    <div class="datetime" id="time"></div>
    <button onclick="location.href='index.html'">ğŸ  <span id="navHome">Home</span></button>
    <button class="disabled">â“ <span id="navHelp">Help</span></button>
    <button onclick="location.href='about.html'">â„¹ï¸ <span id="navAbout">About</span></button>
    <button onclick="location.href='login.html'">ğŸ” <span id="navLogin">Login</span></button>
    <button id="langBtn">Ø§Ù„Ø¹Ø±Ø¨ÙŠØ©</button>
    <button id="themeBtn">ğŸŒ™</button>
  </div>
</header>

<main>
  <!-- Ù‡ÙŠØ±Ùˆ Ø§Ù„Ù…Ø³Ø§Ø¹Ø¯Ø© -->
  <section class="hero-card">
    <div class="hero-inner">
      <div class="hero-text">
        <h1 class="hero-title" id="helpTitle">Help & Support â“</h1>
        <p class="hero-subtitle" id="helpSubtitle">
          Find quick answers, open a ticket, or chat with the assistant about your restaurant apps.
        </p>
        <div class="hero-badges">
          <span class="hero-badge" id="badgeFAQ">FAQ for common questions</span>
          <span class="hero-badge" id="badgeTicket">Support ticket for detailed issues</span>
          <span class="hero-badge" id="badgeAI">AI chat for quick guidance</span>
        </div>
      </div>
      <div class="hero-img">
        <!-- ØµÙˆØ±Ø© Ù‡ÙŠØ±Ùˆ Ù„Ù„Ù…Ø³Ø§Ø¹Ø¯Ø© ÙˆØ§Ù„Ø¯Ø¹Ù… -->
        <img id="heroImgHelp"
             src="https://img.freepik.com/free-vector/customer-support-illustration_114360-7890.jpg"
             alt="Help & support illustration">
      </div>
    </div>
  </section>

  <!-- Ø§Ù„Ø£Ø³Ø¦Ù„Ø© Ø§Ù„Ø´Ø§Ø¦Ø¹Ø© + Ø£Ø²Ø±Ø§Ø± Ø§Ù„ØªØ°ÙƒØ±Ø© Ùˆ AI -->
  <section class="container" id="faqWrapper">
    <div class="headerBar">
      <div class="headerBar-title">
        <span>â“</span>
        <span id="faqTitle">Frequently Asked Questions</span>
      </div>
      <div class="headerBar-actions">
        <button id="ticketBtn" class="secondary">ğŸ« Open Ticket</button>
        <button id="aiBtn" class="primary">ğŸ¤– AI Chat</button>
      </div>
    </div>
    <div class="innerContent">
      <div class="accordion" id="faqContainer"></div>
      <div class="quick-tips" id="quickTips">
        <!-- Ù†Øµ ØªÙ„Ù…ÙŠØ­Ø§Øª ÙŠÙÙ…Ù„Ø£ Ù…Ù† Ø§Ù„Ù„ØºØ© -->
      </div>
    </div>
  </section>

  <!-- Ù†Ù…ÙˆØ°Ø¬ Ø§Ù„ØªØ°ÙƒØ±Ø© -->
  <section class="ticket" id="ticketForm">
    <div class="headerBar">
      <div class="headerBar-title">
        <span>ğŸ«</span>
        <span id="ticketHeader">Open Support Ticket</span>
      </div>
      <button id="backToFAQTicket" class="backBtn">ğŸ”™ Back</button>
    </div>
    <div class="ticket-body">
      <input type="text" id="ticketName" placeholder="Your Name">
      <input type="email" id="ticketEmail" placeholder="Email">
      <textarea rows="4" id="ticketIssue" placeholder="Describe your issue in detail"></textarea>
      <button id="ticketSubmit" class="submitBtn">Submit Ticket</button>
    </div>
  </section>

  <!-- AI Chat -->
  <section class="aiChat" id="aiChat">
    <div class="headerBar">
      <div class="headerBar-title">
        <span>ğŸ¤–</span>
        <span id="aiHeader">AI Assistant Chat</span>
      </div>
      <button id="backToFAQAI" class="backBtn">ğŸ”™ Back</button>
    </div>
    <div class="ai-body">
      <div class="chatArea" id="chatArea"></div>
      <textarea id="aiInput" rows="2" placeholder="Type your question about using the apps..."></textarea>
      <button id="aiSend">Send</button>
    </div>
  </section>
</main>

<footer>Â© 2025 Restaurant Ops Platform</footer>

<script>
// ===== Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø¹Ø§Ù…Ø© =====
const GAS_URL = 'https://script.google.com/macros/s/AKfycbzZiNu7E3n3OMJLCjllvK9fCQ9UoF7-pBQI9EeoSsHDx_zoPNmXekD497M6SEeEMxpw/exec';
let lang = localStorage.getItem("lang") || "en";

// Ø§Ù„ÙˆÙ‚Øª Ù…Ø¹ Ø§Ù„Ø«ÙˆØ§Ù†ÙŠ
function updateTime(){
  const now = new Date();
  const options = {
    weekday:'short',year:'numeric',month:'short',day:'numeric',
    hour:'2-digit',minute:'2-digit',second:'2-digit'
  };
  document.getElementById("time").innerText =
    now.toLocaleString(lang==='ar'?'ar-EG':'en-US', options);
}
updateTime();
setInterval(updateTime,1000);

// ===== Ø¨ÙŠØ§Ù†Ø§Øª FAQ =====
let faqs = [
  {
    q_en:"How do I log in?",
    a_en:"Use the username and password provided by your system administrator or account owner.",
    q_ar:"ÙƒÙŠÙ Ø£Ø³Ø¬Ù„ Ø§Ù„Ø¯Ø®ÙˆÙ„ØŸ",
    a_ar:"Ø§Ø³ØªØ®Ø¯Ù… Ø§Ø³Ù… Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… ÙˆÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ± Ø§Ù„Ù…Ø±Ø³Ù„Ø© Ù…Ù† Ù…Ø¯ÙŠØ± Ø§Ù„Ù†Ø¸Ø§Ù… Ø£Ùˆ Ù…Ø§Ù„Ùƒ Ø§Ù„Ø­Ø³Ø§Ø¨."
  },
  {
    q_en:"I forgot my password, what should I do?",
    a_en:"Click on 'Forgot password' on the login page or contact your administrator to reset it.",
    q_ar:"Ù†Ø³ÙŠØª ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±ØŒ Ù…Ø§Ø°Ø§ Ø£ÙØ¹Ù„ØŸ",
    a_ar:"Ø§Ø¶ØºØ· Ø¹Ù„Ù‰ 'Ù†Ø³ÙŠØª ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±' ÙÙŠ ØµÙØ­Ø© Ø§Ù„Ø¯Ø®ÙˆÙ„ Ø£Ùˆ ØªÙˆØ§ØµÙ„ Ù…Ø¹ Ù…Ø¯ÙŠØ±Ùƒ Ù„Ø¥Ø¹Ø§Ø¯Ø© Ø§Ù„Ø¶Ø¨Ø·."
  },
  {
    q_en:"How do I change the language?",
    a_en:"Use the language button in the top bar to switch between Arabic and English.",
    q_ar:"ÙƒÙŠÙ Ø£ØºÙŠØ± Ø§Ù„Ù„ØºØ©ØŸ",
    a_ar:"Ø§Ø³ØªØ®Ø¯Ù… Ø²Ø± Ø§Ù„Ù„ØºØ© ÙÙŠ Ø§Ù„Ø´Ø±ÙŠØ· Ø§Ù„Ø¹Ù„ÙˆÙŠ Ù„Ù„ØªØ¨Ø¯ÙŠÙ„ Ø¨ÙŠÙ† Ø§Ù„Ø¹Ø±Ø¨ÙŠØ© ÙˆØ§Ù„Ø¥Ù†Ø¬Ù„ÙŠØ²ÙŠØ©."
  },
  {
    q_en:"Which applications are available in the platform?",
    a_en:"You can access timers, smart alerts, logs, and analytics depending on your subscription plan.",
    q_ar:"Ù…Ø§ Ù‡ÙŠ Ø§Ù„ØªØ·Ø¨ÙŠÙ‚Ø§Øª Ø§Ù„Ù…ØªØ§Ø­Ø© ÙÙŠ Ø§Ù„Ù…Ù†ØµØ©ØŸ",
    a_ar:"ÙŠÙ…ÙƒÙ†Ùƒ Ø§Ø³ØªØ®Ø¯Ø§Ù… Ù…Ø¤Ù‚ØªØ§Øª Ø§Ù„Ø®Ø¯Ù…Ø©ØŒ Ø§Ù„ØªÙ†Ø¨ÙŠÙ‡Ø§Øª Ø§Ù„Ø°ÙƒÙŠØ©ØŒ Ø³Ø¬Ù„Ø§Øª Ø§Ù„Ù‡Ø¯Ø± ÙˆØ§Ù„ØªÙ‚Ø§Ø±ÙŠØ± Ø§Ù„ØªØ­Ù„ÙŠÙ„ÙŠØ© Ø­Ø³Ø¨ Ø¨Ø§Ù‚ØªÙƒ."
  },
  {
    q_en:"Can I see reports and analytics?",
    a_en:"Reports are available based on your role. Managers and owners can see detailed dashboards.",
    q_ar:"Ù‡Ù„ Ø£Ø³ØªØ·ÙŠØ¹ Ø±Ø¤ÙŠØ© Ø§Ù„ØªÙ‚Ø§Ø±ÙŠØ± ÙˆØ§Ù„ØªØ­Ù„ÙŠÙ„Ø§ØªØŸ",
    a_ar:"ØªØªÙˆÙØ± Ø§Ù„ØªÙ‚Ø§Ø±ÙŠØ± Ø­Ø³Ø¨ Ø§Ù„ØµÙ„Ø§Ø­ÙŠØ§Øª. Ø§Ù„Ù…Ø¯ÙŠØ±ÙˆÙ† ÙˆÙ…Ø§Ù„ÙƒÙˆ Ø§Ù„Ø­Ø³Ø§Ø¨ ÙŠÙ…ÙƒÙ†Ù‡Ù… Ø¹Ø±Ø¶ Ù„ÙˆØ­Ø§Øª Ù‚ÙŠØ§Ø³ ØªÙØµÙŠÙ„ÙŠØ©."
  },
  {
    q_en:"How do I get help if something is not working?",
    a_en:"First check the FAQ, then open a support ticket with details and screenshots if possible.",
    q_ar:"ÙƒÙŠÙ Ø£Ø­ØµÙ„ Ø¹Ù„Ù‰ Ø§Ù„Ù…Ø³Ø§Ø¹Ø¯Ø© Ø¥Ø°Ø§ ÙƒØ§Ù† Ù‡Ù†Ø§Ùƒ Ø¹Ø·Ù„ØŸ",
    a_ar:"ØªØ­Ù‚Ù‚ Ø£ÙˆÙ„Ù‹Ø§ Ù…Ù† Ø§Ù„Ø£Ø³Ø¦Ù„Ø© Ø§Ù„Ø´Ø§Ø¦Ø¹Ø©ØŒ Ø«Ù… Ø§Ø±ÙØ¹ ØªØ°ÙƒØ±Ø© Ø¯Ø¹Ù… Ù…Ø¹ Ø°ÙƒØ± Ø§Ù„ØªÙØ§ØµÙŠÙ„ ÙˆØ¥Ø±ÙØ§Ù‚ ØµÙˆØ± Ø¥Ù† Ø£Ù…ÙƒÙ†."
  }
];

const faqContainer = document.getElementById("faqContainer");

function renderFAQ(){
  faqContainer.innerHTML = '';
  faqs.forEach(f => {
    const item = document.createElement('div');
    item.className = 'item';

    const q = document.createElement('button');
    q.className = 'question';
    q.innerHTML = `
      <span>${lang==='ar' ? f.q_ar : f.q_en}</span>
      <span class="icon">â•</span>
    `;

    const a = document.createElement('div');
    a.className = 'answer';
    a.innerText = lang==='ar' ? f.a_ar : f.a_en;

    q.onclick = () => {
      const icon = q.querySelector('.icon');
      if(a.style.display === 'block'){
        a.style.display = 'none';
        icon.innerText = 'â•';
      }else{
        a.style.display = 'block';
        icon.innerText = 'â–';
      }
    };

    item.appendChild(q);
    item.appendChild(a);
    faqContainer.appendChild(item);
  });
}

// ===== Ù†ØµÙˆØµ ÙˆØ§Ø¬Ù‡Ø© Ø­Ø³Ø¨ Ø§Ù„Ù„ØºØ© =====
const strings = {
  en: {
    navHome:"Home",
    navHelp:"Help",
    navAbout:"About",
    navLogin:"Login",
    langBtn:"Ø§Ù„Ø¹Ø±Ø¨ÙŠØ©",

    helpTitle:"Help & Support â“",
    helpSubtitle:"Find quick answers, open a ticket, or chat with the assistant about your restaurant apps.",
    badgeFAQ:"FAQ for common questions",
    badgeTicket:"Support ticket for detailed issues",
    badgeAI:"AI chat for quick guidance",

    faqTitle:"Frequently Asked Questions",
    quickTips: "Tip: Start by searching the FAQ. If you still need help, open a support ticket or ask the AI assistant for step-by-step guidance.",

    ticketHeader:"Open Support Ticket",
    namePlaceholder:"Your Name",
    emailPlaceholder:"Email",
    issuePlaceholder:"Describe your issue in detail",
    submitTicket:"Submit Ticket",
    backBtn:"ğŸ”™ Back",

    aiHeader:"AI Assistant Chat",
    aiPlaceholder:"Type your question about using the apps...",
    aiSend:"Send",

    ticketBtn:"ğŸ« Open Ticket",
    aiBtn:"ğŸ¤– AI Chat",

    alertFill:"Please fill all fields.",
    alertSuccess:"Ticket submitted successfully!",
    alertError:"Error submitting ticket.",
    alertErrorWithMsg:"Error submitting ticket: ",

    aiUser:"You",
    aiBot:"AI"
  },
  ar: {
    navHome:"Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©",
    navHelp:"Ø§Ù„Ù…Ø³Ø§Ø¹Ø¯Ø©",
    navAbout:"Ù…Ù† Ù†Ø­Ù†",
    navLogin:"ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„",
    langBtn:"English",

    helpTitle:"â“ Ø§Ù„Ù…Ø³Ø§Ø¹Ø¯Ø© ÙˆØ§Ù„Ø¯Ø¹Ù…",
    helpSubtitle:"Ø§Ø¨Ø­Ø« Ø¹Ù† Ø¥Ø¬Ø§Ø¨Ø§Øª Ø³Ø±ÙŠØ¹Ø©ØŒ Ø§Ø±ÙØ¹ ØªØ°ÙƒØ±Ø© Ø¯Ø¹Ù…ØŒ Ø£Ùˆ Ø§Ø³Ø£Ù„ Ø§Ù„Ù…Ø³Ø§Ø¹Ø¯ Ø¹Ù† Ø§Ø³ØªØ®Ø¯Ø§Ù… ØªØ·Ø¨ÙŠÙ‚Ø§ØªÙƒ.",
    badgeFAQ:"Ø§Ù„Ø£Ø³Ø¦Ù„Ø© Ø§Ù„Ø´Ø§Ø¦Ø¹Ø© Ù„Ø£ÙƒØ«Ø± Ø§Ù„Ø§Ø³ØªÙØ³Ø§Ø±Ø§Øª ØªÙƒØ±Ø§Ø±Ù‹Ø§",
    badgeTicket:"ØªØ°ÙƒØ±Ø© Ø¯Ø¹Ù… Ù„Ù„Ù…Ø´ÙƒÙ„Ø§Øª Ø§Ù„ØªÙØµÙŠÙ„ÙŠØ©",
    badgeAI:"Ø¯Ø±Ø¯Ø´Ø© Ø°ÙƒØ§Ø¡ Ø§ØµØ·Ù†Ø§Ø¹ÙŠ Ù„Ø¥Ø±Ø´Ø§Ø¯ Ø³Ø±ÙŠØ¹",

    faqTitle:"Ø§Ù„Ø£Ø³Ø¦Ù„Ø© Ø§Ù„Ø´Ø§Ø¦Ø¹Ø©",
    quickTips:"ØªÙ„Ù…ÙŠØ­: Ø§Ø¨Ø¯Ø£ Ø¨Ø§Ù„Ø¨Ø­Ø« ÙÙŠ Ø§Ù„Ø£Ø³Ø¦Ù„Ø© Ø§Ù„Ø´Ø§Ø¦Ø¹Ø©. Ø¥Ø°Ø§ Ø§Ø³ØªÙ…Ø± Ø§Ù„Ø¥Ø´ÙƒØ§Ù„ØŒ Ø§Ø±ÙØ¹ ØªØ°ÙƒØ±Ø© Ø¯Ø¹Ù… Ø£Ùˆ Ø§Ø³ØªØ®Ø¯Ù… Ø¯Ø±Ø¯Ø´Ø© Ø§Ù„Ø°ÙƒØ§Ø¡ Ø§Ù„Ø§ØµØ·Ù†Ø§Ø¹ÙŠ Ù„Ù„Ø­ØµÙˆÙ„ Ø¹Ù„Ù‰ Ø¥Ø±Ø´Ø§Ø¯ Ø®Ø·ÙˆØ© Ø¨Ø®Ø·ÙˆØ©.",

    ticketHeader:"Ø±ÙØ¹ ØªØ°ÙƒØ±Ø© Ø¯Ø¹Ù…",
    namePlaceholder:"Ø§Ø³Ù…Ùƒ",
    emailPlaceholder:"Ø§Ù„Ø¨Ø±ÙŠØ¯ Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ",
    issuePlaceholder:"ØµÙ Ø§Ù„Ù…Ø´ÙƒÙ„Ø© Ø¨Ø§Ù„ØªÙØµÙŠÙ„",
    submitTicket:"Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„ØªØ°ÙƒØ±Ø©",
    backBtn:"ğŸ”™ Ø±Ø¬ÙˆØ¹",

    aiHeader:"Ø¯Ø±Ø¯Ø´Ø© Ø§Ù„Ù…Ø³Ø§Ø¹Ø¯ Ø§Ù„Ø°ÙƒÙŠ",
    aiPlaceholder:"Ø§ÙƒØªØ¨ Ø³Ø¤Ø§Ù„Ùƒ Ø¹Ù† Ø§Ø³ØªØ®Ø¯Ø§Ù… Ø§Ù„ØªØ·Ø¨ÙŠÙ‚Ø§Øª...",
    aiSend:"Ø¥Ø±Ø³Ø§Ù„",

    ticketBtn:"ğŸ« Ø±ÙØ¹ ØªØ°ÙƒØ±Ø©",
    aiBtn:"ğŸ¤– Ø¯Ø±Ø¯Ø´Ø© Ø§Ù„Ø°ÙƒØ§Ø¡ Ø§Ù„Ø§ØµØ·Ù†Ø§Ø¹ÙŠ",

    alertFill:"ÙŠØ±Ø¬Ù‰ Ù…Ù„Ø¡ ÙƒÙ„ Ø§Ù„Ø­Ù‚ÙˆÙ„.",
    alertSuccess:"ØªÙ… Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„ØªØ°ÙƒØ±Ø© Ø¨Ù†Ø¬Ø§Ø­!",
    alertError:"Ø­Ø¯Ø« Ø®Ø·Ø£ Ø£Ø«Ù†Ø§Ø¡ Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„ØªØ°ÙƒØ±Ø©.",
    alertErrorWithMsg:"Ø®Ø·Ø£ ÙÙŠ Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„ØªØ°ÙƒØ±Ø©: ",

    aiUser:"Ø£Ù†Øª",
    aiBot:"Ø§Ù„Ù…Ø³Ø§Ø¹Ø¯"
  }
};

function applyLang(){
  const t = strings[lang];

  document.getElementById("navHome").innerText = t.navHome;
  document.getElementById("navHelp").innerText = t.navHelp;
  document.getElementById("navAbout").innerText = t.navAbout;
  document.getElementById("navLogin").innerText = t.navLogin;
  document.getElementById("langBtn").innerText = t.langBtn;

  document.getElementById("helpTitle").innerText = t.helpTitle;
  document.getElementById("helpSubtitle").innerText = t.helpSubtitle;
  document.getElementById("badgeFAQ").innerText = t.badgeFAQ;
  document.getElementById("badgeTicket").innerText = t.badgeTicket;
  document.getElementById("badgeAI").innerText = t.badgeAI;

  document.getElementById("faqTitle").innerText = t.faqTitle;
  document.getElementById("quickTips").innerText = t.quickTips;

  document.getElementById("ticketHeader").innerText = t.ticketHeader;
  document.getElementById("ticketName").placeholder = t.namePlaceholder;
  document.getElementById("ticketEmail").placeholder = t.emailPlaceholder;
  document.getElementById("ticketIssue").placeholder = t.issuePlaceholder;
  document.getElementById("ticketSubmit").innerText = t.submitTicket;
  document.getElementById("backToFAQTicket").innerText = t.backBtn;

  document.getElementById("aiHeader").innerText = t.aiHeader;
  document.getElementById("aiInput").placeholder = t.aiPlaceholder;
  document.getElementById("aiSend").innerText = t.aiSend;
  document.getElementById("backToFAQAI").innerText = t.backBtn;

  document.getElementById("ticketBtn").innerText = t.ticketBtn;
  document.getElementById("aiBtn").innerText = t.aiBtn;

  // Ø§ØªØ¬Ø§Ù‡ ÙˆØ§Ø¬Ù‡Ø© ØªØ³ÙˆÙŠÙ‚ÙŠØ© LTR
  document.documentElement.setAttribute("dir","ltr");
  document.documentElement.setAttribute("lang",lang);

  renderFAQ();
}
applyLang();

// Ø²Ø± Ø§Ù„Ù„ØºØ©
document.getElementById("langBtn").onclick = () => {
  lang = (lang === "en") ? "ar" : "en";
  localStorage.setItem("lang", lang);
  applyLang();
};

// Ø«ÙŠÙ…
document.getElementById("themeBtn").onclick = () => {
  document.body.classList.toggle("dark");
  localStorage.setItem(
    "theme",
    document.body.classList.contains("dark") ? "dark" : "light"
  );
};
if(localStorage.getItem("theme")==="dark"){
  document.body.classList.add("dark");
}

// Ø¥Ø¸Ù‡Ø§Ø±/Ø¥Ø®ÙØ§Ø¡ Ø§Ù„ØªØ°ÙƒØ±Ø© Ùˆ AI
const ticketBtn = document.getElementById("ticketBtn");
const ticketForm = document.getElementById("ticketForm");
const aiBtn = document.getElementById("aiBtn");
const aiChat = document.getElementById("aiChat");
const faqWrapper = document.getElementById("faqWrapper");

ticketBtn.onclick = () => {
  ticketForm.style.display = 'flex';
  aiChat.style.display = 'none';
  faqWrapper.style.display = 'none';
};

aiBtn.onclick = () => {
  aiChat.style.display = 'flex';
  ticketForm.style.display = 'none';
  faqWrapper.style.display = 'none';
};

document.getElementById("backToFAQTicket").onclick = () => {
  ticketForm.style.display = 'none';
  faqWrapper.style.display = 'flex';
};
document.getElementById("backToFAQAI").onclick = () => {
  aiChat.style.display = 'none';
  faqWrapper.style.display = 'flex';
};

// Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„ØªØ°ÙƒØ±Ø©
document.getElementById("ticketSubmit").onclick = async () => {
  const t = strings[lang];
  const name = document.getElementById("ticketName").value.trim();
  const email = document.getElementById("ticketEmail").value.trim();
  const issue = document.getElementById("ticketIssue").value.trim();

  if(!name || !email || !issue){
    alert(t.alertFill);
    return;
  }

  try{
    const res = await fetch(GAS_URL,{
      method:"POST",
      headers:{"Content-Type":"application/json"},
      body:JSON.stringify({name,email,issue})
    });
    const data = await res.json();
    if(data.status==="success"){
      alert(t.alertSuccess);
      document.getElementById("ticketName").value = "";
      document.getElementById("ticketEmail").value = "";
      document.getElementById("ticketIssue").value = "";
    }else{
      alert(t.alertErrorWithMsg + (data.message || "Unknown"));
    }
  }catch(e){
    console.error(e);
    alert(t.alertError);
  }
};

// AI Chat Ø§Ù„Ø¨Ø³ÙŠØ·
const aiInput = document.getElementById("aiInput");
document.getElementById("aiSend").onclick = sendAI;
aiInput.addEventListener("keypress", function(e){
  if(e.key === 'Enter'){
    e.preventDefault();
    sendAI();
  }
});

function sendAI(){
  const t = strings[lang];
  const userQ = aiInput.value.trim();
  if(!userQ) return;

  const chatArea = document.getElementById("chatArea");

  const userDiv = document.createElement('div');
  userDiv.className = 'msg';
  userDiv.innerHTML = `<b>${t.aiUser}:</b> ${userQ}`;
  chatArea.appendChild(userDiv);

  let ans = "";
  const lq = userQ.toLowerCase();

  // Ø¨Ø­Ø« Ø¨Ø³ÙŠØ· ÙÙŠ Ø§Ù„Ø£Ø³Ø¦Ù„Ø© Ø§Ù„Ø´Ø§Ø¦Ø¹Ø©
  faqs.forEach(f => {
    const questionText = (lang==='ar' ? f.q_ar : f.q_en).toLowerCase();
    if(lq.includes(questionText.slice(0, Math.min(10, questionText.length)))){
      ans = lang==='ar' ? f.a_ar : f.a_en;
    }
  });

  // Ø¥Ø¬Ø§Ø¨Ø§Øª Ø§ÙØªØ±Ø§Ø¶ÙŠØ© Ø­Ø³Ø¨ ÙƒÙ„Ù…Ø§Øª Ù…ÙØªØ§Ø­ÙŠØ©
  if(!ans){
    if(lq.includes("login") || lq.includes("Ø¯Ø®ÙˆÙ„") || lq.includes("ØªØ³Ø¬ÙŠÙ„")){
      ans = lang==='ar'
        ? "Ù„ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„ØŒ Ø§Ø³ØªØ®Ø¯Ù… Ø¨ÙŠØ§Ù†Ø§Øª Ø­Ø³Ø§Ø¨Ùƒ Ø«Ù… ØªØ£ÙƒØ¯ Ù…Ù† Ø§Ø®ØªÙŠØ§Ø± Ø§Ù„ÙØ±Ø¹ Ø£Ùˆ Ø§Ù„ØªØ·Ø¨ÙŠÙ‚ Ø§Ù„ØµØ­ÙŠØ­ Ù…Ù† Ù„ÙˆØ­Ø© Ø§Ù„ØªØ­ÙƒÙ…."
        : "To log in, use your account credentials and then select the correct branch or app from the dashboard.";
    }else if(lq.includes("language") || lq.includes("Ù„ØºØ©")){
      ans = lang==='ar'
        ? "ÙŠÙ…ÙƒÙ†Ùƒ ØªØºÙŠÙŠØ± Ø§Ù„Ù„ØºØ© Ù…Ù† Ø²Ø± Ø§Ù„Ù„ØºØ© ÙÙŠ Ø§Ù„Ø´Ø±ÙŠØ· Ø§Ù„Ø¹Ù„ÙˆÙŠ ÙÙŠ Ø£ÙŠ ØµÙØ­Ø© Ù…Ù† ØµÙØ­Ø§Øª Ø§Ù„Ù…Ù†ØµØ©."
        : "You can switch the language from the language button in the top bar on any screen.";
    }else if(lq.includes("report") || lq.includes("ØªÙ‚Ø§Ø±ÙŠØ±")){
      ans = lang==='ar'
        ? "Ø§Ù„ØªÙ‚Ø§Ø±ÙŠØ± Ù…ØªØ§Ø­Ø© Ù…Ù† Ø®Ù„Ø§Ù„ Ù„ÙˆØ­Ø© Ø§Ù„ØªØ­Ù„ÙŠÙ„Ø§Øª Ø¯Ø§Ø®Ù„ Ø­Ø³Ø§Ø¨ÙƒØŒ ÙˆÙ‚Ø¯ ØªØ®ØªÙ„Ù ÙˆÙÙ‚Ù‹Ø§ Ù„ØµÙ„Ø§Ø­ÙŠØ§Øª Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…."
        : "Reports are available from the analytics dashboard inside your account, and access depends on your user role.";
    }else if(lq.includes("timer") || lq.includes("Ù…Ø¤Ù‚Øª")){
      ans = lang==='ar'
        ? "Ù„Ø§Ø³ØªØ®Ø¯Ø§Ù… Ù…Ø¤Ù‚ØªØ§Øª Ø§Ù„Ø®Ø¯Ù…Ø©ØŒ Ø§ÙØªØ­ ØªØ·Ø¨ÙŠÙ‚ Ø§Ù„Ù…Ø¤Ù‚ØªØ§ØªØŒ Ø§Ø®ØªØ± Ù†ÙˆØ¹ Ø§Ù„Ø·Ù„Ø¨ Ø£Ùˆ Ø§Ù„Ø®Ø¯Ù…Ø©ØŒ Ø«Ù… Ø§Ø¨Ø¯Ø£ Ø§Ù„Ù…Ø¤Ù‚Øª Ù„ÙƒÙ„ Ø·Ù„Ø¨."
        : "To use service timers, open the timers app, select the service or order type, and start a timer for each order.";
    }else{
      ans = lang==='ar'
        ? "ÙŠÙ…ÙƒÙ†Ùƒ Ø§Ù„Ø§Ø·Ù„Ø§Ø¹ Ø¹Ù„Ù‰ Ø§Ù„Ø£Ø³Ø¦Ù„Ø© Ø§Ù„Ø´Ø§Ø¦Ø¹Ø© Ø£ÙˆÙ„Ù‹Ø§ØŒ ÙˆØ¥Ø°Ø§ Ø§Ø³ØªÙ…Ø± Ø§Ù„Ø³Ø¤Ø§Ù„ Ø§ÙØªØ­ ØªØ°ÙƒØ±Ø© Ø¯Ø¹Ù… Ù…Ø¹ ØªÙØ§ØµÙŠÙ„ Ø£ÙƒØ«Ø±."
        : "Please check the FAQ first, and if you still need help, open a support ticket with more details.";
    }
  }

  const aiDiv = document.createElement('div');
  aiDiv.className = 'msg';
  aiDiv.innerHTML = `<b>${t.aiBot}:</b> ${ans}`;
  chatArea.appendChild(aiDiv);
  chatArea.scrollTop = chatArea.scrollHeight;

  aiInput.value = '';
}
</script>
</body>
</html>
