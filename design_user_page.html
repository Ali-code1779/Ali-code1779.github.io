<!DOCTYPE html>
<html lang="ar">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Ù„ÙˆØ­Ø© ØªØ­ÙƒÙ… Ø§Ù„Ø£Ø¯Ù…Ù† ğŸ‘¨â€ğŸ’¼</title>
  <style>
    * { box-sizing: border-box; }

    body {
      font-family: 'Arial', sans-serif;
      margin: 0;
      padding: 0;
      direction: rtl;
      background-color: #f5f5f5;
    }

    header {
      position: fixed;
      top: 0;
      left: 0;
      right: 0;
      height: 60px;
      background-color: #007BFF;
      color: white;
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 0 20px;
      z-index: 1000;
    }

    header .controls {
      display: flex;
      align-items: center;
      gap: 10px;
    }

    header .controls button {
      padding: 6px 10px;
      border: none;
      border-radius: 5px;
      cursor: pointer;
      background-color: white;
      color: #007BFF;
      font-weight: bold;
    }

    .menu-container {
      display: flex;
      flex-wrap: wrap;
      justify-content: center;
      gap: 10px;
      background-color: #ffffff;
      padding: 10px 0;
      border-bottom: 1px solid #ccc;
      position: sticky;
      top: 60px;
      z-index: 999;
    }

    .menu-container button {
      background-color: #007BFF;
      color: white;
      border: none;
      padding: 8px 15px;
      border-radius: 5px;
      font-size: 14px;
      cursor: pointer;
      transition: 0.2s;
    }

    .menu-container button:hover {
      background-color: #0056b3;
    }

    .workspace {
      margin-top: 120px;
      padding: 20px;
      min-height: calc(100vh - 120px);
      position: relative;
    }

    iframe.page-frame {
      width: 100%;
      height: 80vh;
      border: none;
      background: white;
      border-radius: 10px;
      box-shadow: 0 0 10px rgba(0,0,0,0.1);
    }

    .spinner {
      position: absolute;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      display: none;
      font-size: 24px;
      color: #007BFF;
    }
  </style>
</head>
<body>

<header>
  <div id="title">Ù„ÙˆØ­Ø© ØªØ­ÙƒÙ… Ø§Ù„Ø£Ø¯Ù…Ù† ğŸ‘¨â€ğŸ’¼</div>
  <div class="controls">
    <span id="date"></span>
    <button onclick="toggleLang()">ğŸŒ English</button>
    <button onclick="logout()">ğŸšª ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø®Ø±ÙˆØ¬</button>
  </div>
</header>

<div class="menu-container" id="topMenu"></div>

<main class="workspace">
  <div class="spinner" id="spinner">â³ Ø¬Ø§Ø±ÙŠ Ø§Ù„ØªØ­Ù…ÙŠÙ„...</div>
  <iframe src="" id="pageFrame" class="page-frame" onload="hideSpinner()"></iframe>
</main>

<script>
  let lang = 'ar';
  let user = JSON.parse(localStorage.getItem("user")) || { name: "Guest", role: "user" };

  const menuItems = [
    { id: 'dashboard', icon: 'ğŸ“Š', page: 'pagesadmin_dashboard.html', roles: ['admin', 'user'] },
    { id: 'users', icon: 'ğŸ‘¥', page: 'pagesuser_dashboard.html', roles: ['admin'] },
    { id: 'apps', icon: 'ğŸ§©', page: 'pagesapps_admin.html', roles: ['admin'] },
    { id: 'settings', icon: 'âš™ï¸', page: 'pages/settings.html', roles: ['admin'] },
    { id: 'reports', icon: 'ğŸ“‘', page: 'pages/reports.html', roles: ['admin'] },
    { id: 'designUserPage', icon: 'ğŸ¨', page: 'pages/design_user_page.html', roles: ['admin'] },
    { id: 'adminControl', icon: 'ğŸ› ï¸', page: 'pages/admin_control.html', roles: ['admin'] },
    { id: 'viewPrograms', icon: 'ğŸ“º', page: 'pages/view_programs.html', roles: ['admin', 'user'] },
    { id: 'programContainers', icon: 'ğŸ“¦', page: 'pages/program_containers.html', roles: ['admin'] },
    { id: 'appButtons', icon: 'ğŸ”˜', page: 'pages/app_buttons.html', roles: ['admin'] },
    { id: 'userDB', icon: 'ğŸ—ƒï¸', page: 'pages/user_db.html', roles: ['admin'] },
    { id: 'userManagement', icon: 'ğŸ§‘â€ğŸ’¼', page: '.html', roles: ['admin'] } // <-- Ø¬Ø¯ÙŠØ¯
  ];

  const labels = {
    ar: {
      dashboard: "Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©",
      users: "Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…ÙŠÙ†",
      apps: "Ø§Ù„ØªØ·Ø¨ÙŠÙ‚Ø§Øª",
      settings: "Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª",
      reports: "ØªÙ‚Ø§Ø±ÙŠØ±",
      designUserPage: "ØªØµÙ…ÙŠÙ… ØµÙØ­Ø© Ù…Ø³ØªØ®Ø¯Ù…",
      adminControl: "Ø¥Ø¯Ø§Ø±Ø©",
      viewPrograms: "Ø§Ù„Ø¨Ø±Ø§Ù…Ø¬ Ø§Ù„Ù…ØªØ§Ø­Ø©",
      programContainers: "ÙƒÙˆÙ†ØªÙŠÙ†Ø±Ø§Øª Ø§Ù„Ø¨Ø±Ø§Ù…Ø¬",
      appButtons: "Ø£Ø²Ø±Ø§Ø± Ø§Ù„ØªØ·Ø¨ÙŠÙ‚Ø§Øª",
      userDB: "Ù‚ÙˆØ§Ø¹Ø¯ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…ÙŠÙ†",
      userManagement: "Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…ÙŠÙ†", // <-- Ø¬Ø¯ÙŠØ¯
      logout: "ğŸšª ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø®Ø±ÙˆØ¬",
      title: "Ù„ÙˆØ­Ø© ØªØ­ÙƒÙ… Ø§Ù„Ø£Ø¯Ù…Ù† ğŸ‘¨â€ğŸ’¼"
    },
    en: {
      dashboard: "Dashboard",
      users: "Users",
      apps: "Apps",
      settings: "Settings",
      reports: "Reports",
      designUserPage: "Design User Page",
      adminControl: "Admin Control",
      viewPrograms: "View Programs",
      programContainers: "Program Containers",
      appButtons: "App Buttons",
      userDB: "User DB",
      userManagement: "User Management", // <-- Ø¬Ø¯ÙŠØ¯
      logout: "ğŸšª Logout",
      title: "Admin Dashboard ğŸ‘¨â€ğŸ’¼"
    }
  };

  function toggleLang() {
    lang = lang === 'ar' ? 'en' : 'ar';
    document.documentElement.lang = lang;
    document.body.dir = lang === 'ar' ? 'rtl' : 'ltr';
    document.getElementById("title").innerText = labels[lang].title;
    document.querySelector("button[onclick='logout()']").innerText = labels[lang].logout;
    document.querySelector("button[onclick='toggleLang()']").innerText = lang === 'ar' ? 'ğŸŒ English' : 'ğŸŒ Ø§Ù„Ø¹Ø±Ø¨ÙŠØ©';
    document.getElementById("date").textContent = new Date().toLocaleDateString(lang === 'ar' ? 'ar-EG' : 'en-US');
    renderMenu();
  }

  function logout() {
    localStorage.removeItem("user");
    window.location.href = "login.html";
  }

  function renderMenu() {
    const menu = document.getElementById("topMenu");
    menu.innerHTML = "";
    menuItems.forEach(item => {
      if (item.roles.includes(user.role)) {
        const btn = document.createElement("button");
        btn.innerHTML = `${item.icon} ${labels[lang][item.id]}`;
        btn.onclick = () => loadPage(item.page);
        menu.appendChild(btn);
      }
    });
  }

  function loadPage(pageUrl) {
    const frame = document.getElementById("pageFrame");
    document.getElementById("spinner").style.display = 'block';
    frame.src = pageUrl;
  }

  function hideSpinner() {
    document.getElementById("spinner").style.display = 'none';
  }

  window.onload = () => {
    if (!user || !user.role) {
      logout();
    }
    document.getElementById("date").textContent = new Date().toLocaleDateString(lang === 'ar' ? 'ar-EG' : 'en-US');
    renderMenu();
    loadPage("pages/admin_dashboard.html"); // ÙŠÙ…ÙƒÙ† ØªØºÙŠÙŠØ±Ù‡ Ù„Ø¢Ø®Ø± ØµÙØ­Ø© ØªÙ… ÙØªØ­Ù‡Ø§
  };
</script>

</body>
</html>
